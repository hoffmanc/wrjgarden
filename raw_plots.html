<html><head>
<script type='application/javascript' src='jquery-1.5.1.js'></script>
<script type='application/javascript' src='plots_raw.js'></script>
<script type="application/javascript" src="canvaslayers.js"></script>
<script type='application/javascript'>
$(function() {
    function toggle(container, plotNo){
        paintedPlotCoords[plotNo] = paintedPlotCoords[plotNo] || {};
        var ppc = paintedPlotCoords[plotNo];

        if(ppc.layer){
           ppc.layer.visible = !ppc.layer.visible;
        } else {
           var x = plotCoords[plotNo][0];
           var y = plotCoords[plotNo][1];
           ppc.layer = initLayer(container, x, y); 
        }
        container.redraw();
    }

    function initLayer(container, x, y){
        var layer = new CanvasLayers.Layer(x-5, y-25, 30, 40);

        layer.onRender = function(layer, rect, context) {
            context.fillStyle = "#000";
            context.strokeRect(0,0,layer.getWidth(),layer.getHeight());
        }

        container.getChildren().add(layer);
        return layer;
    }

    var canvas = $('#ctxPlots')[0];
    var plotCoords = paintPlots(canvas);
    var container = new CanvasLayers.Container(canvas, false);
    var paintedPlotCoords = {};

    for(pc in plotCoords){
      var input = "<input id='plotCoords" + pc + "' name='plotCoords' type='checkbox' data-plotNo='" + pc + "'/>";
      input += "<label for='plotCoords" + pc + "'>" + pc + "</label>";
      $('#plotControls').append("<li>" + input + "</li>");
    }

    $('input[name="plotCoords"]').click(function() {
      toggle(container, $(this).attr('data-plotNo'));
    });
});
</script>
</head>
<body>
    <div style='float:right'>
        <ul id='plotControls'>
        </ul>
    </div>
    <div style='text-align:center;' width='80%' height='815'>
        <canvas id='ctxPlots' width='745' height='813'>Your browser does not support the &lt;CANVAS&gt; element !</canvas>
    </div>
</body>
</html>
