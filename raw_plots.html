<html><head>
<script type='application/javascript' src='jquery-1.5.1.js'></script>
<script type='application/javascript' src='plots_raw.js'></script>
<script type='application/javascript'>
$(function() {
    function toggle(canvas, plotNo){
        paintedPlotCoords[plotNo] = paintedPlotCoords[plotNo] || {};
        var ppc = paintedPlotCoords[plotNo];

        if(ppc.layer){
          $(ppc.layer).toggle();
        } else {
           var x = plotCoords[plotNo][0];
           var y = plotCoords[plotNo][1];
           ppc.layer = initLayer(plotNo, canvas, x, y); 
        }
    }

    function initLayer(plotNo, canvas, x, y){
      config = {
        height: 35,
        width: 35
      };

      var layer = $("<canvas></canvas>");
      layer.attr('id', 'canvas' + plotNo);
      layer.attr('width',config.width);
      layer.attr('height',config.height); 
      layer.attr('style', [
        "position:absolute",
        "left:" + (plotNo < 10 ? x - 5 : x) + "px",
        "top:" + (y-15) + "px",
        "z-index: 1",

        ].join(";")
      );

      $('#plotDisplay').append(layer);

      var context = layer[0].getContext('2d');
      context.arc(config.width / 2, config.height / 2,config.width / 2 - 1,0, 360);
      context.stroke();
      context.fillStyle = "rgba(200, 200, 0, 0.5)";
      context.fill();

      return layer;
    }

    var canvas = $('#ctxPlots')[0];
    var plotCoords = paintPlots(canvas);
    var paintedPlotCoords = {};

    for(pc in plotCoords){
      var input = "<input id='plotCoords" + pc + "' name='plotCoords' type='checkbox' data-plotNo='" + pc + "'/>";
      input += "<label for='plotCoords" + pc + "'>" + pc + "</label>";
      $('#plotControls').append("<li>" + input + "</li>");
    }

    $('input[name="plotCoords"]').click(function() {
      toggle(canvas, $(this).attr('data-plotNo'));
    });
});
</script>
</head>
<body>
    <div style='float:right'>
        <ul id='plotControls' style='list-style-type: none'>
        </ul>
    </div>
    <div id='plotDisplay' width='745' height='813'>
        <canvas id='ctxPlots' style='z-index:0;' width='745' height='813'>Your browser does not support the &lt;CANVAS&gt; element !</canvas>
    </div>
</body>
</html>
